**AdamW æ˜¯æ”¹è¿›ç‰ˆçš„ Adam**ï¼ŒåŒºåˆ«åœ¨äºå®ƒå¯¹ **æƒé‡è¡°å‡ï¼ˆweight decayï¼‰** çš„å¤„ç†æ–¹å¼æ›´åŠ æ­£ç¡®ï¼Œæ›´é€‚åˆæ­£åˆ™åŒ–ã€é¿å…è¿‡æ‹Ÿåˆã€‚

## èƒŒæ™¯çŸ¥è¯†ï¼šAdam çš„é—®é¢˜

Adam ä¼˜åŒ–å™¨ç»“åˆäº†ï¼š

- ä¸€é˜¶åŠ¨é‡ï¼ˆMomentumï¼‰
- äºŒé˜¶åŠ¨é‡ï¼ˆRMSPropï¼‰

å…¶æ›´æ–°å…¬å¼ï¼ˆç®€åŒ–åï¼‰å¦‚ä¸‹ï¼š
$$
\theta_{t+1} = \theta_t - \eta \cdot \frac{\hat{m}_t}{\sqrt{\hat{v}_t} + \epsilon}
$$

------

### ä¼ ç»Ÿåšæ³•ä¸­çš„é”™è¯¯ï¼ˆL2 æ­£åˆ™ vs æƒé‡è¡°å‡ï¼‰

åœ¨ PyTorch ä¸­ï¼ŒAdam é»˜è®¤çš„ `weight_decay` å‚æ•°çš„å®ç°æ–¹å¼æ˜¯ï¼š
$$
g_t = \nabla_\theta L(\theta) + \lambda \cdot \theta
$$

> ä¹Ÿå°±æ˜¯ **æŠŠæƒé‡è¡°å‡å½“ä½œ L2 æ­£åˆ™é¡¹åŠ å…¥äº†æ¢¯åº¦ä¸­**

è¿™ç§åšæ³•å¯¹äº **Adam è¿™æ ·çš„è‡ªé€‚åº”ä¼˜åŒ–å™¨** ä¼šå¯¼è‡´ï¼š

- **æ— æ³•æ­£ç¡®å®ç°çœŸå®æ„ä¹‰ä¸Šçš„ weight decay**
- å› ä¸ºè‡ªé€‚åº”å­¦ä¹ ç‡ä¼šâ€œæŠµæ¶ˆâ€æ‰è¡°å‡æ•ˆæœ
- å¯¼è‡´ **å‚æ•°å¹¶æ²¡æœ‰çœŸçš„è¢«æ‹‰å›åŸç‚¹**ï¼Œè¿‡æ‹Ÿåˆä¾ç„¶ä¸¥é‡



è¿™ä¸ªæ•´ä½“æ¢¯åº¦ï¼ˆåŒ…æ‹¬æ­£åˆ™é¡¹ï¼‰ä¼šè¢« **Adam çš„è‡ªé€‚åº”å› å­ï¼ˆé™¤ä»¥ $\sqrt{v_t}$ï¼‰ç¼©æ”¾**ï¼

**ç»“æœæ˜¯ï¼š**

- å‚æ•°å¤§çš„æ–¹å‘ï¼š**æ¢¯åº¦è¢«æ”¾å¤§**ï¼Œä½†è‡ªé€‚åº”å› å­ä¹Ÿå¤§ â†’ è¢«ç¼©å°
- å‚æ•°å°çš„æ–¹å‘ï¼š**æ¢¯åº¦è¢«ç¼©å°**ï¼Œè‡ªé€‚åº”å› å­ä¹Ÿå° â†’ è¢«æ”¾å¤§

## AdamW çš„è§£å†³æ–¹æ¡ˆï¼ˆæ ¸å¿ƒæ€æƒ³ï¼‰

> **æŠŠæƒé‡è¡°å‡ä»æ¢¯åº¦æ›´æ–°ä¸­åˆ†ç¦»å‡ºæ¥ï¼Œå•ç‹¬åšï¼**

å…¶æ›´æ–°å…¬å¼ä¸ºï¼š
$$
\theta_{t+1} = \theta_t - \eta \cdot \left( \frac{\hat{m}_t}{\sqrt{\hat{v}_t} + \epsilon} + \lambda \cdot \theta_t \right)
$$
æ³¨æ„ï¼š**weight decay æ˜¯ç›´æ¥ä½œç”¨åœ¨å‚æ•°æœ¬èº«ä¸Šï¼Œè€Œä¸æ˜¯åŠ åˆ° loss ä¸Šçš„æ¢¯åº¦é‡Œï¼**

## æ›´å½¢å¼åŒ–åœ°æ¯”è¾ƒï¼š

| ä¼˜åŒ–å™¨     | æ›´æ–°å½¢å¼                                                     |
| ---------- | ------------------------------------------------------------ |
| **Adam**   | $\theta \leftarrow \theta - \eta \cdot (\text{æ¢¯åº¦} + \lambda \theta)$ |
| **AdamW**  | $\theta \leftarrow \theta - \eta \cdot \text{æ¢¯åº¦} - \eta \cdot \lambda \cdot \theta$ |
| ğŸ”‘ é‡ç‚¹å·®å¼‚ | Adam æŠŠ `weight_decay` åŠ è¿›æ¢¯åº¦ï¼›AdamW æ˜¯**ç›´æ¥å‡æƒé‡é¡¹**    |