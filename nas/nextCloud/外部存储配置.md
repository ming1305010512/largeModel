## 1. 查看容器web的用户

```
ps aux | grep apache2
```

## 2. 外部存储如下配置

![image-20260127154757963](C:\Users\16532\AppData\Roaming\Typora\typora-user-images\image-20260127154757963.png)

| 目录      | 配置                    |
| --------- | ----------------------- |
| lm        | /vault/knowledge/lm     |
| chuyin    | /vault/knowledge/chuyin |
| knowledge | /vault/knowledge        |

## 3.  docker-compose.yml添加

```
volumes:
      - /data/vault:/vault

```

这样容器也可执行docker exec -it nextcloud ls /vault/knowledge查看  /data/vault/knowledge下的文件

但是现在只有root用户才能看，但是docker的web用户不是他,一般是www-data，uid为33

现在执行

```
docker exec -u 33 -it nextcloud ls /vault/knowledge
```

是没有权限的

可在容器里执行看进程用户

```
ps aux | grep apache2
```

怎么进容器呢：

```
docker exec -it nextcloud bash
```

接下来执行

```
sudo setfacl -R -m u:33:rwx /data/vault/knowledge
sudo setfacl -R -d -m u:33:rwx /data/vault/knowledge

sudo setfacl -m u:33:x /data
sudo setfacl -m u:33:x /data/vault
```

通过acl控制访问权限
